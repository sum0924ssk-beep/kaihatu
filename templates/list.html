{% extends "base.html" %}
{% block content %}
<style>
/* ... 既存のCSSスタイルはそのまま ... */
</style>

<section class="container">
<h2>登録済み調味料一覧</h2>

<div class="list-grid">
{% for item in condiments %}
<div class="item-card 
     {% if item.is_expired %}expired-card{% elif item.near_expiry %}near-expiry-card{% endif %}"
     data-id="{{ item.id }}"
     data-name="{{ item.name }}"
     data-image="{% if item.image_path %}{{ item.image_path }}{% else %}/static/noimage.png{% endif %}"
     data-expiry="{{ item.expiry }}"
     data-registered="{{ item.registered_date }}" onclick="openModal(this)">
    {% if item.image_path %}
        <img src="{{ item.image_path }}" alt="{{ item.name }}">
    {% else %}
        <img src="/static/noimage.png" alt="no image">
    {% endif %}
    <div class="item-info">
        <p>{{ item.name }}</p>
        <p class="item-date">ID: {{ item.id }}</p>
        <p class="item-date">賞味期限: {{ item.expiry if item.expiry else '未設定' }}</p>
    </div>
</div>
{% endfor %}
</div>
</section>

<div id="itemModal" class="modal">
  </div>

<script>
const modal = document.getElementById("itemModal");
const modalImage = document.getElementById("modalImage");
const modalName = document.getElementById("modalName");
const modalExpiry = document.getElementById("modalExpiry");
const deleteForm = document.getElementById("deleteForm");

function openModal(card) {
  const id = card.dataset.id;
  const name = card.dataset.name;
  const image = card.dataset.image;

  modalName.textContent = name;
  modalImage.src = image;
  modalExpiry.textContent = card.dataset.expiry || "未設定";
  deleteForm.action = `/delete/${id}`;
  modal.style.display = "block";
}

function closeModal() {
  modal.style.display = "none";
}

window.onclick = (e) => {
  if (e.target === modal) closeModal();
};
</script>
{% endblock %}